<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Description for the project page -->
    <meta name="description" content="Detailed analysis and comparison of PID and MPC controllers for high-speed vehicle cornering in CARLA. A project by Reuben Mathew.">
    
    <title>PID vs MPC CARLA Sim - Reuben Mathew</title>
    <meta name="author" content="Reuben Mathew">
    
    <link rel="stylesheet" type="text/css" href="PIDvsMPCstylesheet.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåê</text></svg>">
    
    <link rel="preload" href="https://fonts.gstatic.com/s/lato/v15/S6uyw4BMUTPHjx4wXiWtFCc.woff2" as="font" type="font/woff2" crossorigin>
  </head>

  <body>
    <div class="container">
      <nav class="navbar">
        <div class="navbar-center">
          <a href="https://reubenmathew7.github.io/">Home</a>
          <a href="#control-methodology">Methodology and Control</a>
          <a href="#video-demonstrations">Video Demonstration</a>
          <a href="#results-analysis">Results</a>
          <div class="theme-toggle">
            <label class="switch">
              <input type="checkbox" id="theme-toggle">
              <span class="slider round"></span>
            </label>
            <span class="toggle-label">Dark Mode</span>
          </div>
        </div>
      </nav>
  
      <!-- Start of Project Content -->
    <div class="project-content-wrapper">
      <div>
        <h1 class="name" style="text-align: center;"> Comparative Analysis of PID and Model Predictive Control for High-Speed Vehicle Cornering in CARLA</h1>
        <p style="text-align:center;">
          <strong>Course:</strong> ME 548 ‚Äì Linear Multivariable Control &nbsp; | &nbsp;
          <strong>Project Type:</strong> Individual &nbsp; | &nbsp;
          <strong>Author:</strong> Reuben Mathew &nbsp; | &nbsp;
          <strong>Date:</strong> Spring, 2025
        </p>
        <p style="text-align:center;">
          <a href="https://github.com/reubenmathew7/PID-vs-MPC" target="_blank"><strong>GitHub</strong></a> &nbsp; | &nbsp;
          <a href="https://drive.google.com/file/d/1oru6l5i1ugDTX50rDW9a0URCeL8KiYfk/view?usp=drive_link" target="_blank"><strong>Poster</strong></a> 
        </p>

        <h2>Overview</h2>
        <p>
          This project investigates the performance of Proportional-Integral-Derivative (PID) and Model Predictive Control (MPC) strategies in 
          high-speed autonomous vehicle cornering using the CARLA simulator. While PID is known for its simplicity and ease of tuning, it 
          lacks predictive capabilities, which may limit its performance during aggressive maneuvers. In contrast, MPC utilizes a dynamic model to 
          optimize control inputs over a prediction horizon, enabling it to handle constraints and anticipate future states.
        </p>
        <p>
          The project focuses on benchmarking both control methods on a curved road at increasing speeds (115‚Äì160 km/h), 
          analyzing lane-keeping performance, stability, responsiveness, and control effort. Metrics such as lateral deviation, heading error, steering 
          smoothness, braking patterns, and average speed are used for comparison. This work offers insights into the trade-offs between classical and 
          model-based control strategies in the context of high-speed driving.
        </p>

        <h2>Motivation</h2>
        <p>
          The motivation for this project stems from an interest in how classical and modern control strategies perform in the context of future autonomous driving. 
          While self-driving cars are becoming increasingly prevalent, they are typically seen operating at relatively modest speeds, especially in urban environments. 
          However, as autonomous technology evolves, it is expected that self-driving vehicles will be required to perform safely and reliably at highway or 
          expressway speeds ‚Äî a scenario that demands higher responsiveness and stability from their control systems.
        </p>
        <p>
          Among the most widely adopted control approaches in autonomous vehicles are PID (Proportional-Integral-Derivative) and MPC (Model Predictive Control). 
          This project aims to explore which of these strategies may offer better performance under high-speed, curved road conditions. 
          The findings could be relevant not only for future self-driving vehicles operating at faster speeds but also for domains such as autonomous racing, 
          including F1.
        </p>
        <p>
          Beyond practical applications, this project also serves a personal purpose: having already worked with PID controllers and learning MPC in the current 
          academic quarter, I was curious to compare their real-world behavior and limitations in a rigorous testing environment. 
          Combining this curiosity with a long-standing passion for cars made it natural to explore this comparison in the context of vehicle dynamics.
        </p>

        <h2>Objectives</h2>
        <ul>
          <li>To evaluate and compare the performance of PID and MPC controllers in high-speed cornering scenarios.</li>
          <li>To measure controller effectiveness using cross-track error, heading deviation, and lane stability.</li>
          <li>To assess responsiveness and control smoothness using steering, throttle, and brake effort.</li>
          <li>To determine which controller maintains higher stability and performance across increasing speeds.</li>
          <li>To provide visual and statistical evidence for controller behavior and effectiveness using simulation data.</li>
        </ul>

        <h2>Simulation Environment</h2>
        <p>
          All experiments were conducted using <a href="https://carla.org/" target="_blank" rel="noopener noreferrer">CARLA 0.9.14</a>, 
          an open-source simulator for autonomous driving research. Python 3.10 was used to interface with CARLA‚Äôs API.
        </p>
        <p>
          The vehicle used was the <strong>Mercedes Coupe 2020</strong> from the CARLA vehicle blueprint library. The simulation took place in 
          <a href="https://carla.readthedocs.io/en/latest/map_town04/" target="_blank" rel="noopener noreferrer"><strong>Town04</strong></a>, 
          which includes two distinct types of curved segments:
        </p>

        <ul>
          <li>2 turns with approximately 60-meter radius (no banking)</li>
          <li>4 turns with approximately 165-meter radius (no banking)</li>
        </ul>
        <p>
          These road geometries were selected to test the controllers' ability to maintain lane position and stability under different levels of curvature at high speeds (115‚Äì160 km/h).
        </p>

        <!-- Side-by-side images -->
        <div style="display: flex; justify-content: space-between; flex-wrap: wrap; gap: 10px; margin-top: 15px;">
          <div style="flex: 1 1 48%;">
            <img src="town04aerial.jpg" alt="CARLA Simulator" style="width: 100%; height: auto;">
            <p style="text-align:center;"><small>Figure: CARLA Town 4 Track Aerial View</small></p>
          </div>
          <div style="flex: 1 1 48%;">
            <img src="town04track.png" alt="Town 4 Track Layout" style="width: 100%; height: auto;">
            <p style="text-align:center;"><small>Figure: Town 4 track</small></p>
          </div>
        </div>
        <p>
          Both the PID and MPC models were tuned specifically for <strong>maximum speed</strong> operation while maintaining <strong>moderate stability</strong> to evaluate performance under aggressive cornering scenarios. This tuning approach reflects real-world constraints in high-speed autonomous driving where responsiveness is critical, but excessive conservatism may limit top performance.
        </p>

        <p>
          <strong>Assumptions: </strong>The simulation environment assumes ideal operating conditions without perception or estimation uncertainty. Key assumptions include:
        </p>
        <ul>
          <li><strong>Full-State Availability:</strong> All vehicle states (position, velocity, heading, etc.) are directly accessible without the need for estimation or sensor fusion.</li>
          <li><strong>No Perception Stack:</strong> The simulation excludes object detection, classification, or semantic understanding. No obstacle avoidance logic is implemented.</li>
          <li><strong>Single-Agent Control:</strong> The vehicle operates in a static, obstacle-free environment with no interaction with other agents or traffic.</li>
          <li><strong>Vehicle Dynamics Model:</strong> Control logic is based on an ideal kinematic bicycle model. Effects such as tire slip, actuator delay, or dynamic load transfer are not considered.</li>
          <li><strong>Failure Criteria and Speed Limit:</strong> Drifts of up to 90¬∞ from the lane heading are considered valid. Any yaw deviation beyond 90¬∞ by both the vehicles, or collisions with stationary objects, are treated as failure conditions. Based on empirical testing on the Town04 track, the maximum reliably achievable speed was found to be 160 km/h for atleast one of the cars.</li>
          <li>
            <strong>Vehicle Dynamics Model:</strong> Control logic is based on an ideal kinematic bicycle model. Effects such as tire slip, actuator delay, or dynamic load transfer are not considered.
            Specifically, vehicle drift dynamics were not incorporated into the MPC model due to the highly non-linear nature of drift, which would significantly overcomplicate the control problem and was considered beyond the scope of this project. While the simulated vehicle may exhibit drift at high speeds, the controller does not explicitly model or compensate for it. This could be an area for future enhancement.
          </li>
        </ul>

        <!-- Show Libraries Used -->
        <details style="margin-top: 20px;margin-bottom:20px">
          <summary><strong>Libraries Used</strong></summary>
          <pre><code>
                import carla
                import numpy as np
                import time
                import math
                import random
                import traceback
                import matplotlib.pyplot as plt
                from scipy.optimize import minimize
                import pandas as pd
                import os
          </code></pre>
        </details>

        <section id="control-methodology" style="margin-top:30px;">
        <h2>Control Strategy</h2>
        <p>
          This project implements and compares two distinct control strategies for high-speed vehicle navigation in CARLA:
          Model Predictive Control (MPC) and Proportional-Integral-Derivative (PID) control. Both controllers aim to achieve a
          target speed of <strong>140.0 km/h</strong> while accurately tracking a predefined path. The simulation operates
          with a fixed time step (<code>SIMULATION_STEP</code>) of <strong>0.05 seconds</strong>. The vehicle model used has a
          wheelbase (<code>VEHICLE_L</code>) of <strong>2.8 meters</strong>.
        </p>

        <hr style="margin: 20px 0;">

        <h3>Model Predictive Control (MPC)</h3>
        <p>
          MPC is an advanced control strategy that uses an explicit model of the vehicle to predict its future states
          over a finite time horizon. It then optimizes a sequence of control inputs (steering and acceleration)
          by minimizing a predefined cost function. This process is repeated at each time step, providing a proactive
          and optimal control action.
        </p>

        <h4>MPC Parameters:</h4>
        <ul>
          <li><strong>Prediction Horizon (<code>MPC_HORIZON</code>):</strong> 7 steps</li>
          <li><strong>Discretization Time Step (<code>MPC_DT</code>):</strong> 0.05 seconds (same as <code>SIMULATION_STEP</code>)</li>
          <li><strong>Maximum Steering Angle (<code>MAX_STEER_RAD</code>):</strong> ¬±45 degrees</li>
          <li><strong>Maximum Acceleration (<code>MAX_ACCEL</code>):</strong> +2.0 m/s<sup>2</sup></li>
          <li><strong>Minimum Acceleration (Braking) (<code>MIN_ACCEL</code>):</strong> -2.0 m/s<sup>2</sup></li>
        </ul>

        <h4>Vehicle Model (Kinematic Bicycle Model):</h4>
        <p>
          The MPC utilizes a kinematic bicycle model to predict the vehicle's state. The state is defined as
          <code>[x, y, œà, v]</code>, representing the vehicle's X-coordinate, Y-coordinate, yaw angle, and speed, respectively.
          The control inputs are acceleration (<code>a</code>) and steering angle (<code>Œ¥</code>).
        </p>
        <div style="text-align: center; margin-top: 15px; margin-bottom: 15px;">
          <img src="kinematic bicycle model.png" alt="Kinematic Bicycle Model Diagram" style="max-width: 50%; height: auto; border-radius: 6px;">
        </div>
        <p style="text-align:center;"><small>Figure: Kinematic Bicycle Model</small></p>
        <p>The discrete-time state update equations are:</p>
        <pre class="code-block">
                                x<sub>k+1</sub> = x<sub>k</sub> + v<sub>k</sub> ¬∑ cos(œà<sub>k</sub>) ¬∑ dt
                                y<sub>k+1</sub> = y<sub>k</sub> + v<sub>k</sub> ¬∑ sin(œà<sub>k</sub>) ¬∑ dt
                                œà<sub>k+1</sub> = œà<sub>k</sub> + (v<sub>k</sub> / L) ¬∑ tan(Œ¥<sub>k</sub>) ¬∑ dt
                                v<sub>k+1</sub> = v<sub>k</sub> + a<sub>k</sub> ¬∑ dt
        </pre>
        <p>Where <code>L</code> is the wheelbase and <code>dt</code> is the time step.</p>

        <h4>Cost Function:</h4>
        <p>
          The optimizer seeks to minimize a cost function <code>J</code> over the prediction horizon <code>N</code>.
          The cost function penalizes deviations from the reference trajectory, excessive control effort, and rapid changes in control inputs.
        </p>
        <pre class="code-block">
                                    J = Œ£<sub>i=0</sub><sup>N-1</sup> [
                                        W<sub>CTE</sub> ¬∑ (CTE<sub>i</sub>)<sup>2</sup> +
                                        W<sub>HE</sub> ¬∑ (HE<sub>i</sub>)<sup>2</sup> +
                                        W<sub>VS</sub> ¬∑ (v<sub>error,i</sub>)<sup>2</sup> +
                                        W<sub>STEER</sub> ¬∑ (Œ¥<sub>i</sub>)<sup>2</sup> +
                                        W<sub>ACCEL</sub> ¬∑ (a<sub>i</sub>)<sup>2</sup> +
                                        W<sub>DSTEER</sub> ¬∑ (ŒîŒ¥<sub>i</sub>)<sup>2</sup> +
                                        W<sub>DACCEL</sub> ¬∑ (Œîa<sub>i</sub>)<sup>2</sup> ]
        </pre>
        <p>Where:</p>
        <ul>
          <li><code>CTE</code>: Cross-Track Error (distance to reference path)</li>
          <li><code>HE</code>: Heading Error (difference from reference yaw)</li>
          <li><code>v<sub>error</sub></code>: Velocity error (difference from reference speed)</li>
          <li><code>Œ¥</code>: Steering angle input</li>
          <li><code>a</code>: Acceleration input</li>
          <li><code>ŒîŒ¥</code>: Change in steering angle from the previous step</li>
          <li><code>Œîa</code>: Change in acceleration from the previous step</li>
        </ul>
        <p>The weights used are:</p>
        <ul>
          <li><code>W_CTE</code>: 5.0</li>
          <li><code>W_HE</code>: 5.0</li>
          <li><code>W_VS</code>: 4.0</li>
          <li><code>W_STEER</code>: 10.0</li>
          <li><code>W_ACCEL</code>: 1.0</li>
          <li><code>W_DSTEER</code>: 100.0 (penalizes rapid steering changes heavily)</li>
          <li><code>W_DACCEL</code>: 10.0</li>
        </ul>

        <h4>Optimization:</h4>
        <p>
          The optimal control sequence <code>[a<sub>0</sub>, Œ¥<sub>0</sub>, ..., a<sub>N-1</sub>, Œ¥<sub>N-1</sub>]</code>
          is found using the Sequential Least Squares Programming (SLSQP) algorithm provided by <code>scipy.optimize.minimize</code>.
          The optimization is subject to the defined bounds on acceleration and steering angle.
          Only the first control action <code>(a<sub>0</sub>, Œ¥<sub>0</sub>)</code> from the optimized sequence is applied to the vehicle,
          and the process is repeated at the next time step (receding horizon control).
        </p>

        <h4>Reference Trajectory Generation:</h4>
        <p>
          At each step, a reference trajectory consisting of <code>N</code> waypoints (state <code>[x, y, œà, v]</code> for each step in the horizon)
          is generated. This is done by querying the CARLA map (<code>carla_map_obj</code>) for waypoints along the current lane.
          Waypoints are projected forward based on the target speed and the MPC discretization time step (<code>MPC_DT</code>).
          Logic is included to select the appropriate lane (e.g., second lane from the left on Town04) and handle scenarios
          where the end of a road segment is reached within the horizon.
        </p>

        <hr style="margin: 20px 0;">

        <h3>Proportional-Integral-Derivative (PID) Control</h3>
        <p>
          The PID control strategy is a reactive approach that continuously calculates an error value as the difference
          between a desired setpoint and a measured process variable. It then applies a correction based on proportional,
          integral, and derivative terms of this error.
        </p>
        <p>
          Two independent PID controllers are used:
        </p>
        <ul>
          <li><strong>Lateral Control (Steering):</strong> A PID controller to minimize a combined error based on heading error and cross-track error (CTE).</li>
          <li><strong>Longitudinal Control (Throttle/Brake):</strong> A PID controller to regulate the vehicle's speed towards the target speed.</li>
        </ul>

        <h4>PID Controller Parameters & Gains:</h4>
        <ul>
          <li><strong>Steering PID:</strong>
            <ul>
              <li><code>STEER_KP</code>: 0.6</li>
              <li><code>STEER_KI</code>: 0.005</li>
              <li><code>STEER_KD</code>: 0.20</li>
            </ul>
          </li>
          <li><strong>Throttle PID:</strong>
            <ul>
              <li><code>THROTTLE_KP</code>: 0.5</li>
              <li><code>THROTTLE_KI</code>: 0.02</li>
              <li><code>THROTTLE_KD</code>: 0.01</li>
            </ul>
          </li>
          <li><strong>Integral Term Limit:</strong> ¬±2.0 (for anti-windup)</li>
          <li><strong>Simulation Time Step (<code>dt</code> for PID):</strong> 0.05 seconds</li>
        </ul>

        <h4>Error Calculation:</h4>
        <ul>
          <li>
            <strong>Speed Error:</strong> <code>Target Speed - Current Speed</code>.
          </li>
          <li>
            <strong>Heading Error (Yaw Error):</strong> The angle between the vehicle's current heading and the direction
            to a lookahead waypoint on the path. The lookahead distance (<code>WAYPOINT_LOOKAHEAD</code>) is <strong>12.0 meters</strong>.
            Calculated as <code>atan2(sin(œà<sub>target</sub> - œà<sub>current</sub>), cos(œà<sub>target</sub> - œà<sub>current</sub>))</code>.
          </li>
          <li>
            <strong>Cross-Track Error (CTE):</strong> The perpendicular distance from the vehicle to the center line of the target lane.
            It's calculated by taking the dot product of the vector from the nearest waypoint on the path to the vehicle,
            with the right-vector of that waypoint.
          </li>
          <li>
            <strong>CTE Correction Angle:</strong> An additional steering correction term derived from the CTE, calculated as
            <code>atan2(-CTE, CTE_CORRECTION_LOOKAHEAD)</code>, where <code>CTE_CORRECTION_LOOKAHEAD</code> is <strong>8.0 meters</strong>.
            This aims to steer the vehicle back towards the centerline.
          </li>
          <li>
            <strong>Combined Steering Error:</strong> The input to the steering PID controller is
            <code>Heading Error + (CTE_CORRECTION_WEIGHT ¬∑ CTE Correction Angle)</code>,
            where <code>CTE_CORRECTION_WEIGHT</code> is <strong>0.7</strong>.
          </li>
        </ul>

        <h4>PID Control Law:</h4>
        <p>The standard discrete PID control law is implemented as:</p>
        <pre class="code-block">
                 Error<sub>k</sub> = Setpoint<sub>k</sub> - MeasuredValue<sub>k</sub>
                 Integral<sub>k</sub> = Integral<sub>k-1</sub> + Error<sub>k</sub> ¬∑ dt
                 Derivative<sub>k</sub> = (Error<sub>k</sub> - Error<sub>k-1</sub>) / dt
                 Output<sub>k</sub> = (K<sub>p</sub> ¬∑ Error<sub>k</sub>) + (K<sub>i</sub> ¬∑ Integral<sub>k</sub>) + (K<sub>d</sub> ¬∑ Derivative<sub>k</sub>)
        </pre>
        <p>The integral term is clamped to prevent integral windup.</p>

        <h4>Control Output and Logic:</h4>
        <ul>
          <li>Steering command (<code>steer_cmd</code>) is clamped between -1.0 and 1.0.</li>
          <li>Throttle command (<code>throttle_cmd</code>) is clamped between 0.0 and 1.0.</li>
          <li>
            <strong>Braking Logic:</strong>
            <ul>
              <li>If <code>speed_error < -10 km/h</code> (overspeeding), brake is applied proportionally to the error, and throttle is set to 0.</li>
              <li>If <code>abs(steer_cmd) > 0.5</code> and speed is above a threshold (40% of target speed), gentle braking is applied, and throttle is reduced.</li>
              <li>A safety brake (0.5 brake, 0.0 throttle) is engaged if <code>abs(CTE) > 2.0 meters</code> or <code>abs(Heading Error) > 30 degrees</code> while speed is above 70 km/h.</li>
            </ul>
          </li>
        </ul>
        <h4>Path Following:</h4>
        <p>
          The PID controller relies on identifying the correct lane (initially the second lane from the left on Town04, with <code>target_lane_id</code>)
          and then finding the nearest waypoint on that lane. Waypoints are projected ahead to calculate errors. Logic is included to
          attempt to "hop" to the target lane if the vehicle strays.
        </p>
      </section>

        <section id="methodology" style="margin-top:30px;">
          <h2>Methodology & Data Analysis</h2>
          <p>
            The comparative analysis of the PID and MPC controllers was conducted through a systematic series of simulations and subsequent data processing.
            The core methodology involved:
          </p>

          <ol>
            <li>
              <strong>Controller Implementation:</strong>
              <p>
                Python scripts were developed to implement both the PID and MPC control logics. These scripts interfaced with the CARLA simulator API to:
              </p>
              <ul>
                <li>Spawn and control the 'vehicle.mercedes.coupe_2020'.</li>
                <li>Set the CARLA world to synchronous mode with a fixed delta time of 0.05 seconds for deterministic simulations.</li>
                <li>Generate reference waypoints for path following.</li>
                <li>Apply calculated control commands (throttle, brake, steer) to the vehicle.</li>
                <li>Log relevant simulation data at each time step.</li>
              </ul>
              <p>
                Both controllers were tuned for high-speed operation with a focus on achieving maximum possible speed while maintaining moderate stability on the curved sections of Town04.
              </p>
            </li>

            <li>
              <strong>Simulation Runs:</strong>
              <p>
                For each controller (PID and MPC), a series of <strong>10 distinct simulation runs</strong> were executed. Each run targeted a specific constant speed, incrementing from <strong>115 km/h to 160 km/h</strong> in 5 km/h steps.
                During each run, the vehicle attempted to complete one full lap of the predefined circuit in Town04.
              </p>
              <p>
                Key data points logged during each simulation included:
              </p>
              <ul>
                <li>Time (<code>sim_time_plot</code>)</li>
                <li>Actual vehicle speed (<code>current_speed_kmh_val</code>)</li>
                <li>Steering command (<code>steer_cmd</code>)</li>
                <li>Throttle command (<code>throttle_cmd</code>)</li>
                <li>Brake command (<code>brake_cmd</code>)</li>
                <li>Cross-Track Error (CTE) (<code>cte_val_plot</code> or <code>cte</code>)</li>
                <li>Heading Error (<code>heading_error_val_plot</code> or <code>yaw_error_rad</code>)</li>
                <li>Actual vehicle X and Y coordinates (<code>current_carla_location.x, .y</code>)</li>
                <li>Ideal (reference) X and Y coordinates (<code>ref_traj_np[0,0], ref_traj_np[0,1]</code> or <code>ideal_location_for_plot_carla.x, .y</code>)</li>
              </ul>
              <p>
                This data was saved to CSV files, named systematically (e.g., <code>pid_data_140.csv</code>, <code>mpc_data_140.csv</code>) for each controller and target speed.
              </p>
            </li>

            <li>
              <strong>Data Post-Processing and Analysis:</strong>
              <p>
                A separate Python script utilizing <code>pandas</code> for data manipulation and <code>matplotlib</code> for plotting was developed to analyze the collected CSV data. The analysis script performed the following key operations:
              </p>
              <ul>
                <li>
                  <strong>Data Aggregation:</strong> Loaded data from all simulation runs for both PID and MPC.
                </li>
                <li>
                  <strong>Time Synchronization & Interpolation:</strong>
                  To compare runs of varying durations and ensure consistent data points for averaging, a common time grid was established based on the shortest simulation run. Data for longer runs (CTE, Heading Error, Steering, Throttle, Brake) was interpolated onto this common time grid using linear interpolation (<code>scipy.interpolate.interp1d</code>). This step was crucial for generating meaningful average performance plots over time.
                </li>
                <li>
                  <strong>Calculation of Performance Metrics & Plot Generation:</strong>
                  <ul>
                    <li><strong>Total Simulation Time vs. Target Speed:</strong> Plotted to show how long each controller took to complete the lap at different target speeds.</li>
                    <li><strong>Average CTE vs. Time:</strong> Averaged interpolated CTE values across all runs for each controller, plotted against the common time grid.</li>
                    <li><strong>Average Heading Error vs. Time:</strong> Similar to CTE, averaged interpolated heading errors were plotted.</li>
                    <li><strong>Average Steering Command vs. Time:</strong> Visualized the mean steering effort over time.</li>
                    <li><strong>Average Throttle and Brake vs. Time:</strong> Showed mean longitudinal control effort.</li>
                    <li><strong>Overall Average Speed:</strong> Calculated the mean speed achieved by each controller across all its runs and time points on the common grid.</li>
                    <li><strong>Average Lane Exits per Run:</strong> Counted instances where the absolute CTE exceeded a threshold (1.5 meters) for each run, then averaged these counts per controller.</li>
                    <li><strong>Ideal Path Visualization:</strong> Plotted the <code>x_ideal</code> and <code>y_ideal</code> coordinates from a sample run to visually inspect the track's curvature.</li>
                  </ul>
                </li>
              </ul>
              <p>
                The live plotting capabilities within the CARLA simulation scripts (<code>setup_plots</code>, <code>update_trajectory_plot</code>, <code>update_live_data_plots</code>) also provided real-time feedback during individual runs, aiding in tuning and initial assessment. Post-simulation plots (<code>generate_post_simulation_plots</code>) offered immediate insights into CTE and heading error for each specific run.
              </p>
            </li>
          </ol>
          <p>
            This comprehensive methodology allowed for a robust quantitative and qualitative comparison of the PID and MPC controllers across a range of challenging high-speed scenarios.
          </p>
        </section>
        
    <!--NEW VIDEO DEMONSTRATIONS SECTION STARTS HERE-->
    <section id="video-demonstrations" style="margin-top:30px;">
      <h2>Video Demonstrations</h2>
      <p>
        The following videos demonstrate the comparative performance of the PID and MPC controllers in action within the CARLA simulator
        at different target speeds. Each set of videos below presents the vehicle's behavior under PID control and MPC control
        side-by-side for a given target speed on the Town04 circuit.
      </p>

      <div class="video-set-container" style="margin-bottom: 30px;">
        <h3>PID vs. MPC at 115 km/h</h3>
        <p>
          This demonstration shows the controllers operating at a target speed of 115 km/h.
          The left video shows the PID controller, and the right video shows the MPC controller.
          Observe the differences in path tracking, stability, and control smoothness, particularly around the curved sections.
        </p>
        
        <div class="dual-video-wrapper" style="display: flex; justify-content: space-between; gap: 15px; flex-wrap: wrap; margin-top:10px;">
          <!-- PID Video at 115 km/h -->
        <div class="video-player-container" style="flex: 1 1 48%; min-width: 300px;">
          <h4 style="text-align:center; margin-bottom: 5px;">PID Controller at 115 km/h</h4>

          <div class="video-wrapper">
            <img class="video-thumbnail" src="PID 115.png" alt="Poster for PID 115">
            <video class="hover-video" muted playsinline preload="none" controls="on">
              <source src="PID 115.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        </div>

                  <!-- MPC Video at 115 km/h -->
        <div class="video-player-container" style="flex: 1 1 48%; min-width: 300px;">
          <h4 style="text-align:center; margin-bottom: 5px;">MPC Controller at 115 km/h</h4>

          <div class="video-wrapper">
            <img class="video-thumbnail" src="MPC 115.png" alt="Poster for MPC 115">
            <video class="hover-video" muted playsinline preload="none" controls="on">
              <source src="MPC 115.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        </div>
        </div>
        <p style="text-align:center; margin-top: 10px;">
            <small>Figure: Comparison of PID (left) and MPC (right) controllers at 115 km/h.</small>
        </p>
      </div>

      <hr style="margin: 20px 0;">

      <div class="video-set-container" style="margin-bottom: 30px;">
        <h3>PID vs. MPC at 160 km/h</h3>
        <p>
          This demonstration showcases the controllers at a significantly higher target speed of 160 km/h.
          The left video shows the PID controller, and the right video shows the MPC controller.
          This more challenging scenario highlights the limits of each controller in terms of stability and
          path adherence under aggressive cornering conditions.
        </p>

        <div class="dual-video-wrapper" style="display: flex; justify-content: space-between; gap: 15px; flex-wrap: wrap; margin-top:10px;">
          <!-- PID Video at 160 km/h -->
        <div class="video-player-container" style="flex: 1 1 48%; min-width: 300px;">
          <h4 style="text-align:center; margin-bottom: 5px;">PID Controller at 160 km/h</h4>

          <div class="video-wrapper">
            <img class="video-thumbnail" src="PID 160.png" alt="Poster for PID 160">
            <video class="hover-video" muted playsinline preload="none" controls="on">
              <source src="PID 160.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        </div>

          <!-- MPC Video at 160 km/h -->
        <div class="video-player-container" style="flex: 1 1 48%; min-width: 300px;">
          <h4 style="text-align:center; margin-bottom: 5px;">MPC Controller at 160 km/h</h4>

          <div class="video-wrapper">
            <img class="video-thumbnail" src="MPC 160.png" alt="Poster for PID 160">
            <video class="hover-video" muted playsinline preload="none" controls="on">
              <source src="MPC 160.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        </div>
      </div>
        <p style="text-align:center; margin-top: 10px;">
            <small>Figure: Comparison of PID (left) and MPC (right) controllers at 160 km/h.</small>
        </p>
    </section>

        <!-- RESULTS AND ANALYSIS SECTION STARTS HERE -->
        <section id="results-analysis" style="margin-top:30px;">
          <h2>Results and Analysis</h2>
          <p>
            The performance characteristics of the Proportional-Integral-Derivative (PID) and Model Predictive Control (MPC) strategies were systematically evaluated. Data was acquired from simulations conducted at target velocities ranging from 115 km/h to 160 km/h on the Town04 circuit within the CARLA environment. The subsequent analysis delves into simulation efficiency, trajectory stability (quantified by cross-track and heading errors), control effort expenditure (steering, throttle, and brake commands), and overall lane-keeping proficiency.
          </p>

          <hr style="margin: 30px 0;">

          <!-- 1. Simulation Efficiency Analysis -->
          <article class="analysis-block">
            <h3>1. Simulation Efficiency: Lap Completion Time as a Function of Target Speed</h3>
            <p>
              Overall performance efficiency was assessed by quantifying the <strong>total simulation time</strong> each controller required to complete a full lap of the designated circuit at a spectrum of target speeds. A reduced lap time is indicative of superior path following, characterized by fewer and less significant corrective maneuvers, thereby reflecting higher overall trajectory efficiency.
            </p>
            <figure style="text-align:center; margin: 20px 0;">
              <img src="Sim Time vs Speed.png" alt="Plot of Total Simulation Time vs Target Speed for PID and MPC" style="max-width: 90%; height: auto; border: 1px solid #ddd; border-radius: 4px;">
              <figcaption style="margin-top: 5px;"><small>Figure: Lap completion times for PID and MPC controllers across target speeds (115 km/h to 160 km/h).</small></figcaption>
            </figure>
            
            <h4>Observations:</h4>
            <ul>
              <li>At lower to moderate velocities (115‚Äì140 km/h), the PID controller exhibited greater agility, completing the driving task with shorter lap times compared to the MPC.</li>
              <li>A distinct performance inflection point was observed at approximately 145 km/h, beyond which the MPC strategy consistently yielded lower lap times.</li>
              <li>The PID controller's performance profile demonstrated a U-shaped characteristic, with lap times reaching a minimum near 140 km/h before subsequently increasing. This pattern suggests a potential degradation in stability or an escalation in lateral corrective effort at elevated speeds.</li>
              <li>Conversely, MPC displayed a more monotonic improvement in lap times up to 150 km/h, followed by a subtle plateau, implying sustained control efficiency even as vehicle speed increased.</li>
              <li>At the upper limit of the tested speed range (160 km/h), MPC completed the lap approximately <strong>3.5 seconds faster</strong> than PID, highlighting its enhanced stability and efficiency under high-speed conditions.</li>
            </ul>

          <div class="table-responsive-wrapper">
              <table class="summary-table">
                  <thead>
                      <tr>
                          <th>Speed Range</th>
                          <th>Controller with Lower Lap Time</th>
                          <th>Attributed Factors</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td>115 ‚Äì 140 km/h</td>
                          <td>PID</td>
                          <td>Rapid response characteristics, minimal computational overhead for planning</td>
                      </tr>
                      <tr>
                          <td>145 ‚Äì 160 km/h</td>
                          <td>MPC</td>
                          <td>Superior high-speed stability, smoother corrective actions due to predictive capability</td>
                      </tr>
                  </tbody>
              </table>
          </div>

            <h4>Conclusion on Simulation Efficiency:</h4>
            <p>
              The lap time analysis reveals a significant <strong>performance crossover phenomenon</strong>. While PID's inherent responsiveness offers an efficiency advantage at moderate speeds, MPC's predictive control paradigm becomes increasingly beneficial as speeds exceed 140 km/h. At higher velocities, the ability to anticipate upcoming path curvatures and required state adjustments allows MPC to generate more optimized and cleaner trajectories, thereby minimizing overcorrections and enhancing overall efficiency.
            </p>
            <p>These findings suggest distinct operational regimes:</p>
            <ul>
              <li>PID's lightweight architecture and immediate responsiveness render it suitable for low to medium-speed applications where computational simplicity is valued.</li>
              <li>MPC demonstrates superior efficacy in high-speed, dynamically demanding scenarios, particularly those involving significant road curvature, where predictive foresight and robust stability are paramount for optimal performance.</li>
            </ul>
          </article>

          <hr style="margin: 30px 0;">

          <!-- 2. Stability Analysis: CTE and Heading Error -->
          <article class="analysis-block">
            <h3>2. Trajectory Stability Analysis: Cross-Track and Heading Error Dynamics</h3>
            <p>
              The stability of the trajectories generated by each controller was assessed by analyzing two principal metrics, averaged across all simulation runs: Cross-Track Error (CTE), defined as the lateral deviation from the ideal path centerline, and Heading Error, representing the angular deviation from the desired vehicle orientation. For equitable comparison, data were interpolated onto a common time grid, constrained by the duration of the shortest experimental run.
            </p>

            <h4>Cross-Track Error (CTE) Analysis:</h4>
            <figure style="text-align:center; margin: 20px 0;">
              <img src="Average CTE vs Time.png" alt="Plot of Average CTE vs Time" style="max-width: 90%; height: auto; border: 1px solid #ddd; border-radius: 4px;">
              <figcaption style="margin-top: 5px;"><small>Figure: Average Cross-Track Error (CTE) vs. Time, normalized across runs.</small></figcaption>
            </figure>
            <p>The temporal profiles of average CTE revealed distinct control characteristics:</p>
            <ul>
              <li>MPC generally maintained closer proximity to the lane centerline, exhibiting a consistently lower average CTE throughout the simulations.</li>
              <li>PID, while demonstrating effective tracking, was characterized by fewer oscillatory deviations, but these tended to be of greater magnitude when they occurred, suggesting a more forceful reactive correction.</li>
              <li>In contrast, MPC enacted smaller, more frequent lateral adjustments, indicative of its continuous optimization process and predictive error compensation.</li>
              <li>Both controllers proved competent in path tracking; however, MPC achieved notably smoother lane adherence, a benefit particularly evident during navigation through curved road segments.</li>
            </ul>

            <h4>Heading Error Analysis:</h4>
            <figure style="text-align:center; margin: 20px 0;">
              <img src="Average Heading Error vs Time.png" alt="Plot of Average Heading Error vs Time" style="max-width: 90%; height: auto; border: 1px solid #ddd; border-radius: 4px;">
              <figcaption style="margin-top: 5px;"><small>Figure: Average Heading Error vs. Time, normalized across runs.</small></figcaption>
            </figure>
            <p>Analysis of heading error dynamics showed subtle yet consistent differences in orientation control:</p>
            <ul>
              <li>PID exhibited slightly larger peak heading errors, a tendency more pronounced during sharp turns or aggressive high-speed transitions.</li>
              <li>MPC, conversely, demonstrated more consistent heading alignment, characterized by smaller-amplitude, smoother oscillations over the course of the run.</li>
              <li>Significantly, neither controller displayed indications of extreme instability; both effectively guided the vehicle towards zero error recuperation following disturbances.</li>
              <li>While discernible differences in heading performance were present, particularly in challenging track segments, the overall disparity was not substantial.</li>
            </ul>
            
          <div class="table-responsive-wrapper">
              <table class="summary-table">
                  <thead>
                      <tr>
                          <th style="border: 1px solid #ddd; padding: 8px;">Metric</th>
                          <th style="border: 1px solid #ddd; padding: 8px;">PID Controller Characteristics</th>
                          <th style="border: 1px solid #ddd; padding: 8px;">MPC Controller Characteristics</th>
                          <th style="border: 1px solid #ddd; padding: 8px;">Comparative Summary</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td style="border: 1px solid #ddd; padding: 8px;">CTE Magnitude & Frequency</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">Larger, less frequent deviations</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">Smaller, more frequent corrections</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">MPC achieved slightly better centering; PID's errors were less frequent but larger.</td>
                      </tr>
                      <tr>
                          <td style="border: 1px solid #ddd; padding: 8px;">Heading Error Profile</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">Slightly larger peaks, especially during sharp turns</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">More consistent alignment, lower-magnitude drift</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">MPC demonstrated a smoother overall heading error profile.</td>
                      </tr>
                      <tr>
                          <td style="border: 1px solid #ddd; padding: 8px;">Correction Style</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">Aggressive, reactive to errors</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">Gradual, predictive adjustments</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">PID exhibited quicker initial reaction; MPC showed more stable corrective phases.</td>
                      </tr>
                      <tr>
                          <td style="border: 1px solid #ddd; padding: 8px;">Overall Path Stability</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">Generally stable, but more susceptible to error spikes</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">Higher consistency, reduced error variance</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">MPC demonstrated marginally superior overall stability and smoothness.</td>
                      </tr>
                  </tbody>
              </table>
          </div>

            <h4>Conclusion on Stability:</h4>
            <p>
              Both PID and MPC controllers successfully maintained vehicle stability across the tested operational envelope. However, <strong>MPC exhibited a discernible advantage in terms of consistency and smoothness of the trajectory</strong>. While the absolute difference in peak error magnitudes was not extensive, MPC's predictive methodology facilitated a more refined control output, proving particularly beneficial in high-velocity maneuvers and through complex road geometries. PID's inherent responsiveness offers utility in rapid error nullification, yet MPC's proactive adjustments generally contribute to a more composed and predictable vehicle behavior over extended operational periods.
            </p>
          </article>

          <hr style="margin: 30px 0;">

          <!-- 3. Steering Effort Analysis -->
          <article class="analysis-block">
            <h3>3. Control Effort Profile: Steering Command Dynamics</h3>
            <p>
              The average steering command signal, analyzed over time and across all tested speeds, provides critical insights into the control behavior and responsiveness of each strategy. This metric particularly illuminates the frequency and intensity of corrective steering actions, especially during cornering or deviation recovery.
            </p>
            <figure style="text-align:center; margin: 20px 0;">
              <img src="Average Steering Command vs Time.png" alt="Plot of Average Steering Command vs Time" style="max-width: 90%; height: auto; border: 1px solid #ddd; border-radius: 4px;">
              <figcaption style="margin-top: 5px;"><small>Figure: Average Steering Command vs. Time.</small></figcaption>
            </figure>

            <h4>Key Observations:</h4>
            <ul>
              <li>PID's steering command profile was characterized by <strong>sharper, more pronounced changes</strong>, with distinct spikes (e.g., around the 70-second mark). This pattern is indicative of more aggressive, reactive corrections, likely initiated in response to larger accumulated trajectory deviations.</li>
              <li>MPC, in contrast, demonstrated <strong>more frequent but smaller-amplitude steering adjustments</strong>. This reflects a more tightly regulated control loop, emphasizing continuous, predictive micro-corrections to maintain the desired path.</li>
              <li>The increased density of MPC's steering activity, particularly evident in the 35‚Äì55 second interval, highlights its fine-grained approach to path correction during dynamically complex segments of the track.</li>
              <li>While PID's steering inputs involved fewer substantial adjustments, these larger peaks often corresponded to reactive recovery maneuvers from preceding overshoots or deviations.</li>
            </ul>
            <p>Despite these contrasting stylistic approaches to steering control, it is noteworthy that both controllers maintained overall trajectory smoothness, with <strong>no evidence of erratic or unstable steering oscillations</strong> that would compromise vehicle stability or passenger comfort.</p>

      <div class="table-responsive-wrapper">
          <table class="summary-table">
              <thead>
                  <tr>
                      <th style="border: 1px solid #ddd; padding: 8px;">Aspect</th>
                      <th style="border: 1px solid #ddd; padding: 8px;">PID Controller Steering Profile</th>
                      <th style="border: 1px solid #ddd; padding: 8px;">MPC Controller Steering Profile</th>
                      <th style="border: 1px solid #ddd; padding: 8px;">Comparative Steering Behavior</th>
                  </tr>
              </thead>
              <tbody>
                  <tr>
                      <td style="border: 1px solid #ddd; padding: 8px;">Peak Steering Magnitude</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Larger spikes, occurring less frequently</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Smaller, more frequent fluctuations</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">MPC exhibited smoother steering inputs with lower peak magnitudes.</td>
                  </tr>
                  <tr>
                      <td style="border: 1px solid #ddd; padding: 8px;">Correction Frequency & Intensity</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Less frequent, higher magnitude corrections</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">More frequent, lower magnitude corrections</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Strategies differed: PID was reactive and forceful; MPC was proactive and incremental.</td>
                  </tr>
                  <tr>
                      <td style="border: 1px solid #ddd; padding: 8px;">Steering Stability & Smoothness</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Reactive, aggressive when necessary</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Predictive, yielding smoother adjustments</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Both demonstrated relatively stable and smooth steering control.</td>
                  </tr>
                  <tr>
                      <td style="border: 1px solid #ddd; padding: 8px;">Response to Curves</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Strong, impulsive steering initiation</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Gradual, sustained steering application</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">Both effective; PID offered sharper turn-in, MPC smoother negotiation.</td>
                  </tr>
              </tbody>
          </table>
      </div>
            
            <h4>Conclusion on Steering Effort:</h4>
            <p>
              The steering command analysis elucidates the fundamental differences in control philosophy. PID's tendency towards sharper, less frequent corrections can facilitate rapid trajectory recovery but may also introduce a degree of abruptness or risk overshooting the target path. Conversely, MPC's strategy of distributing control effort through smaller, more frequent adjustments typically results in a more stable and smoother driving profile. This reinforces the observation that <strong>MPC prioritizes consistent stability and smoothness</strong>, particularly advantageous in high-speed or curve-intensive driving, whereas <strong>PID's strength lies in its immediate responsiveness and error correction capabilities</strong>.
            </p>
          </article>

          <hr style="margin: 30px 0;">

          <!-- 4. Power Command Analysis -->
          <article class="analysis-block">
            <h3>4. Longitudinal Control Dynamics: Throttle and Brake Command Analysis</h3>
            <p>
              An analysis of the average throttle and brake commands was performed to evaluate how each controller managed speed regulation and deceleration. These signals offer insights into the smoothness of power modulation and the extent to which each strategy relies on aggressive braking versus nuanced throttle corrections during curves and transitional maneuvers.
            </p>
            <figure style="text-align:center; margin: 20px 0;">
              <img src="Average throttle and break vs time.png" alt="Plot of Average Throttle and Brake vs Time" style="max-width: 90%; height: auto; border: 1px solid #ddd; border-radius: 4px;">
              <figcaption style="margin-top: 5px;"><small>Figure: Average Throttle and Brake Commands vs. Time.</small></figcaption>
            </figure>

            <h4>Key Observations:</h4>
            <ul>
              <li>The overall throttle application strategy was largely consistent between the two controllers, with both exhibiting predictable reductions in throttle during cornering and increases during straight-line acceleration phases.</li>
              <li>PID's throttle output displayed slightly more pronounced and frequent oscillations, particularly during mid-run transitions and in the vicinity of the 70-second mark, suggesting a more reactive style of throttle adjustment.</li>
              <li>MPC's throttle command profiles were demonstrably smoother, characterized by fewer abrupt changes, a behavior consistent with its predictive control methodology.</li>
              <li>Brake application was minimal for both controllers, manifesting as brief, low-magnitude spikes at only a few junctures during the lap, indicative of generally efficient speed management.</li>
              <li>In a specific instance around the 75-second mark, PID engaged marginally stronger braking; however, apart from this, braking patterns were nearly identical and infrequently utilized by both systems.</li>
            </ul>

        <div class="table-responsive-wrapper">
            <table class="summary-table">
                <thead>
                    <tr>
                        <th style="border: 1px solid #ddd; padding: 8px;">Aspect</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">PID Controller Power Profile</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">MPC Controller Power Profile</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">Comparative Power Management</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 8px;">Throttle Smoothness</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">Minor oscillations observed in several segments</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">Smoother ramp-ups and declines in throttle application</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">MPC provided smoother throttle modulation.</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 8px;">Brake Usage</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">Few, sharper brake spikes</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">Slightly softer, infrequent brake responses</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">Both used brakes sparingly; differences were minimal.</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 8px;">Overall Power Stability</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">More reactive throttle adjustments</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">More predictive and even-handed power delivery</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">MPC demonstrated more stable and predictive power control.</td>
                    </tr>
                </tbody>
            </table>
        </div>

            <h4>Conclusion on Power Command:</h4>
            <p>
              Both controllers demonstrated effective throttle and brake management, characterized by <strong>minimal reliance on braking</strong> and appropriate throttle modulation throughout the simulated driving task. While the PID controller occasionally exhibited greater variability in throttle application, <strong>MPC consistently maintained smoother and more stable acceleration control</strong>. These patterns are congruent with previous observations regarding trajectory tracking and steering behavior, reaffirming MPC's emphasis on predictive, smooth control, while PID remains effective through its slightly more reactive, yet capable, approach.
            </p>
          </article>

          <hr style="margin: 30px 0;">

          <!-- 5. Speed and Lane Keeping Performance -->
          <article class="analysis-block">
            <h3>5. Aggregate Performance: Average Speed and Lane Keeping Integrity</h3>
            <p>
              In addition to detailed analysis of trajectory tracking and control effort, two key aggregate performance metrics were evaluated across all runs: the average speed maintained over the lap, and the frequency of lane departures.
            </p>

            <h4>Average Speed Maintained:</h4>
        <div class="table-responsive-wrapper">
            <table class="summary-table">
                <thead>
                    <tr>
                        <th style="border: 1px solid #ddd; padding: 8px;">Controller</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">Average Speed</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 8px;">PID</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">120.45 km/h</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 8px;">MPC</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">120.50 km/h</td>
                    </tr>
                </tbody>
            </table>
        </div>
            <p>
              <strong>Conclusion on Average Speed:</strong> Despite discernible differences in control behavior and trajectory smoothness, both controllers achieved <strong>remarkably similar average speeds</strong> across the entirety of the test runs. This suggests that neither strategy significantly compromised longitudinal performance in pursuit of stability or corrective precision, and both effectively managed throttle and brake inputs to sustain comparable cruising velocities.
            </p>

            <h4>Lane Keeping Performance (Lane Exits):</h4>
            <p>
              To quantify path adherence and safety, the number of instances where each controller allowed the vehicle's cross-track error (CTE) to exceed a threshold of ¬±1.5 meters was recorded. Such an event was defined as the vehicle effectively departing its designated lane.
            </p>
          <div class="table-responsive-wrapper">
              <table class="summary-table">
                  <thead>
                      <tr>
                          <th style="border: 1px solid #ddd; padding: 8px;">Controller</th>
                          <th style="border: 1px solid #ddd; padding: 8px;">Average Lane Exits per Run</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td style="border: 1px solid #ddd; padding: 8px;">PID</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">49.10</td>
                      </tr>
                      <tr>
                          <td style="border: 1px solid #ddd; padding: 8px;">MPC</td>
                          <td style="border: 1px solid #ddd; padding: 8px;">14.50</td>
                      </tr>
                  </tbody>
              </table>
          </div>
            <p>The disparity in lane exit frequency is substantial: <strong>PID resulted in over three times more lane departures</strong> on average when compared to MPC. This observation aligns coherently with earlier findings indicating that:</p>
            <ul>
              <li>PID's tendency towards aggressive corrective actions can occasionally lead to overshoots and subsequent oscillatory drifting beyond lane boundaries.</li>
              <li>MPC consistently maintains smoother trajectory control, benefiting from predictive planning, which allows it to adhere to lane boundaries with significantly greater reliability.</li>
            </ul>
            <p>
              <strong>Conclusion on Lane Exits:</strong> While both controllers achieved comparable average speeds, <strong>MPC demonstrated markedly superior performance in lane keeping stability</strong>, evidenced by a substantially lower frequency of lane exits per run. This positions MPC as a more robust candidate for applications where safety and consistent, precise lane tracking are critical operational requirements, particularly in challenging curved geometries or high-speed driving environments.
            </p>
          </article>

        </section>

        <!-- OVERALL PROJECT CONCLUSION STARTS HERE -->
        <section id="project-conclusion" style="margin-top:30px;">
          <h2>Overall Conclusion</h2>
          <p>
            This comparative study of PID and Model Predictive Control (MPC) for high-speed autonomous vehicle cornering in the CARLA simulator has yielded insightful distinctions between these classical and modern control strategies.
            Both controllers demonstrated competence in navigating the challenging Town04 circuit at speeds ranging from 115 km/h to 160 km/h, albeit with characteristic differences in performance, stability, and control behavior.
          </p>

          <h4>Performance Synthesis: A Tale of Two Controllers</h4>
          <p>
            The analysis revealed a clear **performance crossover point around 140 km/h**.
            At lower to moderate speeds (115-140 km/h), the <strong>PID controller's lightweight nature and rapid responsiveness</strong> translated to slightly faster lap completion times. Its simpler architecture allowed for immediate corrective actions with minimal computational overhead.
          </p>
          <p>
            However, as target speeds increased beyond this threshold (145-160 km/h), the <strong>MPC controller consistently outperformed PID in overall efficiency and stability</strong>. MPC's core strength, its predictive capability based on an internal vehicle model, became increasingly advantageous. By anticipating future trajectory requirements and optimizing control inputs over a horizon, MPC achieved:
          </p>
          <ul>
            <li><strong>Smoother Trajectories:</strong> Exhibiting lower average Cross-Track Error (CTE) and more consistent heading alignment, particularly through demanding curves.</li>
            <li><strong>Enhanced Stability:</strong> Producing smaller, more frequent corrections for both steering and throttle, leading to less variance and fewer large error spikes compared to PID's more aggressive, reactive style.</li>
            <li><strong>Superior Lane Keeping:</strong> Demonstrating a significantly lower number of lane departures (over three times fewer than PID), a critical factor for safety and reliability in autonomous driving.</li>
          </ul>
          <p>
            While both controllers maintained very similar average cruising speeds across all test conditions, indicating that neither unduly sacrificed speed for control, the qualitative aspects of their performance diverged significantly. PID's approach often involved sharper, more impulsive corrections, effective for quick recovery but sometimes leading to overshoots. MPC, in contrast, favored a more composed, even-handed application of control effort, resulting in a more stable and refined driving profile.
          </p>

          <h4>Key Takeaways and Implications:</h4>
          <p>
            The findings from this project underscore that the choice between PID and MPC is not absolute but rather **context-dependent**, hinging on the specific operational demands and performance priorities:
          </p>
          <ul>
            <li>
              <strong>PID remains a viable and efficient solution for scenarios prioritizing immediate responsiveness and simplicity, particularly at low to medium speeds</strong> where its reactive nature can quickly address deviations without the computational burden of predictive models.
            </li>
            <li>
              <strong>MPC emerges as the superior strategy for high-speed, dynamically complex environments, especially those involving significant curvature.</strong> Its predictive foresight, ability to handle constraints, and capacity for smoother, more stable control make it a stronger candidate where safety, precision lane tracking, and ride comfort are paramount. The significantly better lane-keeping performance of MPC at higher speeds is a compelling testament to its advantages.
            </li>
          </ul>
          <p>
            Ultimately, this investigation confirms that while classical PID control offers a robust baseline, the advanced capabilities of Model Predictive Control provide a tangible edge in pushing the boundaries of autonomous vehicle performance, particularly as operational speeds and environmental complexity increase. The trade-off lies between PID's simplicity and responsiveness versus MPC's sophisticated predictive power and enhanced stability.
          </p>
          <p>
            For future autonomous systems, especially those intended for highway speeds or performance driving, the nuanced, proactive control offered by MPC presents a more promising path towards achieving both high performance and robust safety.
          </p>
        </section>

        <!-- REFERENCES SECTION STARTS HERE -->
        <section id="references" style="margin-top:30px;">
          <h2>References</h2>
          <p>
            This project builds upon foundational concepts in control theory, vehicle dynamics, simulation technology, and specific software tools. Key resources and prior work that informed this study include:
          </p>
          <ol style="line-height: 1.6;">
            <li>
              CARLA Simulator Documentation. (n.d.). Retrieved from <a href="https://carla.org/" target="_blank" rel="noopener noreferrer">https://carla.org/</a>
            </li>
            <li>
              Dosovitskiy, A., Ros, G., Codevilla, F., Lopez, A., & Koltun, V. (2017). CARLA: An Open Urban Driving Simulator. <em>Conference on Robot Learning (CoRL)</em>, 1-16.
              Retrieved from <a href="http://proceedings.mlr.press/v78/dosovitskiy17a.html" target="_blank" rel="noopener noreferrer">http://proceedings.mlr.press/v78/dosovitskiy17a.html</a>
            </li>
            <li>
              Nuhel, A. K., Amin, M. A., & Paul, D. (2024). Model Predictive Control (MPC) and PID Control for Autonomous Lane Keeping: A Comparative Study. In <em>Cognitive Computing and Cyber Physical Systems</em>. Springer.
            </li>
            <li>
              Abdallaoui, S., Krib√®che, A., & Aglzim, E. H. (2022). Comparative Study of MPC and PID Controllers in Autonomous Vehicle Application. In <em>Advances in Automation, Mechanical and Design Engineering</em>. Springer.
            </li>
            <li>
              Diamond, S., Grant, E., Boyd, S., & Haupt, J. (2016). CVXPY: A Python-Embedded Modeling Language for Convex Optimization. <em>Journal of Machine Learning Research</em>, 17(83), 1-5.
              Retrieved from <a href="http://jmlr.org/papers/v17/16-408.html" target="_blank" rel="noopener noreferrer">http://jmlr.org/papers/v17/16-408.html</a>
            </li>
             <li>
              √Östr√∂m, K. J., & H√§gglund, T. (2006). <em>Advanced PID Control</em>. ISA - The Instrumentation, Systems, and Automation Society.
            </li>
            <li>
              Camacho, E. F., & Bordons, C. (2007). <em>Model Predictive Control</em> (2nd ed.). Springer-Verlag London.
            </li>
            <li>
              Rajamani, R. (2011). <em>Vehicle Dynamics and Control</em> (2nd ed.). Springer US.
            </li>
            <li>
              Course Notes and Website: <em>Linear Multivariable Control (ME 548, Spring 2025)</em>. Retrieved from <a href="https://uw-ctrl.github.io/lmc-book/index.html" target="_blank" rel="noopener noreferrer">https://uw-ctrl.github.io/lmc-book/index.html</a>
            </li>
            <li>
              Python Software Foundation. (n.d.). <em>Python Language Reference</em>.
              Retrieved from <a href="https://www.python.org" target="_blank" rel="noopener noreferrer">https://www.python.org</a>
            </li>
            <li>
              Virtanen, P., Gommers, R., Oliphant, T. E., et al. (2020). SciPy 1.0: fundamental algorithms for scientific computing in Python. <em>Nature methods</em>, 17(3), 261-272.
              Retrieved from <a href="https://www.nature.com/articles/s41592-019-0686-2" target="_blank" rel="noopener noreferrer">https://www.nature.com/articles/s41592-019-0686-2</a>
            </li>
          </ol>
        </section>
        <!--REFERENCES SECTION ENDS HERE -->

        <p style="text-align:center; margin-top: 30px;">
          <p style="text-align: center; font-size: 13px;"> <a href="#" style="text-decoration: none; color: #1772d0;">Back to top ‚Üë</a> </p>
        </p>
      </div>
    </div>
       

    </div>

    <div id="imageModal" class="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.9); z-index:1000;">
        <img id="modalImage" style="max-width:90%; max-height:90%; margin:auto; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);">
        <span onclick="closeModal()" style="position:absolute; top:15px; right:35px; color:white; font-size:40px; cursor:pointer;">√ó</span>
    </div>

    <script>
    function openModal(src) {
        document.getElementById('imageModal').style.display = "block";
        document.getElementById('modalImage').src = src;
    }

    function closeModal() {
        document.getElementById('imageModal').style.display = "none";
    }
    </script>

    <div id="videoModal" class="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.9); z-index:1000;">
        <video id="modalVideo" controls style="max-width:90%; max-height:90%; margin:auto; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);">
            <source src="" type="video/mp4">
        </video>
        <span onclick="closeVideoModal()" style="position:absolute; top:15px; right:35px; color:white; font-size:40px; cursor:pointer;">√ó</span>
    </div>

    <script>
    function openVideoModal(videoElementClicked) {
        const videoModal = document.getElementById('videoModal');
        const modalVideoPlayer = document.getElementById('modalVideo');
        let videoSrc = videoElementClicked.dataset.src;
        if (!videoSrc && videoElementClicked.querySelector('source')) {
            videoSrc = videoElementClicked.querySelector('source').src;
        } else if (!videoSrc && videoElementClicked.src) {
             videoSrc = videoElementClicked.src;
        }

        if (videoSrc) {
            modalVideoPlayer.src = videoSrc;
            videoModal.style.display = "block";
            modalVideoPlayer.play();
        } else {
            console.error("Video source not found for modal.");
        }
    }

    function closeVideoModal() {
        const videoModal = document.getElementById('videoModal');
        const modalVideoPlayer = document.getElementById('modalVideo');
        modalVideoPlayer.pause();
        modalVideoPlayer.src = "";
        videoModal.style.display = "none";
    }
    </script>

    <script>
    document.addEventListener("DOMContentLoaded", function () {
        const toggleSwitch = document.getElementById("theme-toggle");
        const body = document.body;
        const label = document.querySelector(".toggle-label");
    
        if (localStorage.getItem("theme") === "dark") {
            body.classList.add("dark-mode");
            toggleSwitch.checked = true;
            if (label) label.textContent = "Light Mode";
        } else {
            if (label) label.textContent = "Dark Mode";
        }
    
        toggleSwitch.addEventListener("change", function () {
            if (this.checked) {
                body.classList.add("dark-mode");
                localStorage.setItem("theme", "dark");
                if (label) label.textContent = "Light Mode";
            } else {
                body.classList.remove("dark-mode");
                localStorage.setItem("theme", "light");
                if (label) label.textContent = "Dark Mode";
            }
        });
    });
    </script>

    <script>
      const tooltip = document.querySelector('.click-to-expand');
      const projects = document.querySelectorAll('.project');

      projects.forEach(project => {
        const video = project.querySelector('.project-video');
        if (!video || video.classList.contains('static-video')) return;

        let sourceAdded = false;

        project.addEventListener('mouseenter', () => {
          if (!sourceAdded && video.dataset.src) {
            const source = document.createElement('source');
            source.src = video.dataset.src;
            source.type = 'video/mp4';
            video.appendChild(source);
            video.load();
            sourceAdded = true;
          }
          if (video.readyState >= 2) {
            video.play().catch(e => console.warn("Video play interrupted or failed:", e));
          } else {
            video.oncanplay = () => video.play().catch(e => console.warn("Video play interrupted or failed (oncanplay):", e));
          }
        });

        project.addEventListener('mouseleave', () => {
          video.pause();
          video.currentTime = 0;
          video.removeAttribute('controls');
          if (tooltip) tooltip.style.opacity = '0';
        });

        if (tooltip) {
            video.addEventListener('mouseenter', () => {
            tooltip.style.opacity = '1';
            video.setAttribute('controls', 'controls');
            });

            video.addEventListener('mousemove', (e) => {
            tooltip.style.top = `${e.clientY + 15}px`;
            tooltip.style.left = `${e.clientX + 15}px`;
            });

            video.addEventListener('mouseleave', () => {
            tooltip.style.opacity = '0';
            video.removeAttribute('controls');
            });
        }
      });
    </script>
<script>
  document.querySelectorAll('.video-wrapper').forEach(wrapper => {
    const img = wrapper.querySelector('.video-thumbnail');
    const video = wrapper.querySelector('.hover-video');

    function revealAndPlay() {
      if (video.style.display !== 'block') {
        img.style.display = 'none';
        video.style.display = 'block';
        video.play();
      }
    }

    img.addEventListener('click', revealAndPlay);
    img.addEventListener('mouseenter', revealAndPlay);
  });
</script>
  </body>
</html>
